修改个人资料,点击 update account settings 后, 保存成功,但是刷新页面,还是显示旧的资料。
ajax 提交时,about_me 是空字符串,没有取页面上输入的值。


右上角铃铛,点击没有弹出下拉列表。点击后,开发者控制台报js 错误。


mark all as read 待测试。



点击搜索按钮的一瞬间, 如果上一次 ajax 轮询获取上次搜索结果有返回了, 会直接显示在列表里面。



搜索条件是:
get task {
  task_id: 'fe1fedb255eb84a4538bfc80a1cf3e45',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'San Francisco, CA',
    origin_radius: '100',
    destination: 'San Francisco, CA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589542303
}

Uber Freight 报错:
Uber Freight: searchPrepare
Uber Freight: search page loaded
screenshot: Uber Freight-search error.png
Uber Freight: search error TimeoutError: waiting for selector "[data-baseweb=flex-grid] [data-baseweb="flex-grid-item"]" failed: timeout 10000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at UberFreight.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:34:25)
    at UberFreight.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at UberFreight.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:34:25)
    at UberFreight.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}


查看 http://54.219.50.46/screenshot/Uber%20Freight-search%20error.png ,显示的还在 sign in 的输入邮箱页面。






landstar 搜索时报错:
Landstar: searchPrepare
screenshot: Landstar-search error.png
Landstar: search error TimeoutError: waiting for selector "#OriginRadius" failed: timeout 30000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Landstar.search (/home/ubuntu/puppeteer/dist/sites/www.landstaronline.com.js:37:20)
    at Landstar.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Landstar.search (/home/ubuntu/puppeteer/dist/sites/www.landstaronline.com.js:37:20)
    at Landstar.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}

http://54.219.50.46/screenshot/Landstar-search%20error.png 是登录页面。




同时 enable landstar 和 werner 时, redis 里面应该有两个task, landstar 报错后, 另一个task 就没有了。不知道为什么。



sunteck 搜索时报错:
Sunteck: searchPrepare
logout Sunteck: logout in search page
screenshot: Sunteck-search error.png
Sunteck: search error SiteError { type: 'logout', msg: 'Sunteck: logout in search page' }

http://54.219.50.46/screenshot/Sunteck-search%20error.png 是登录页面




Echo search 搜索失败

Search doTask
Echo: searchPrepare
screenshot: Echo-search error.png
Echo: search error TimeoutError: waiting for selector ".search-btn" failed: timeout 5000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Echo.search (/home/ubuntu/puppeteer/dist/sites/echodrive.echo.com.js:32:25)
    at Echo.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Echo.search (/home/ubuntu/puppeteer/dist/sites/echodrive.echo.com.js:32:25)
    at Echo.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}

http://54.219.50.46/screenshot/Echo-search%20error.png  是登录页面。






coyote 搜索失败。

Coyote: searchPrepare
timeout Coyote: search page load timeout
Coyote: begin search
Coyote: search loaded
screenshot: Coyote-search error.png
Coyote: search error TimeoutError: waiting for selector "#export-to-excel:not(:disabled)" failed: timeout 10000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Coyote.search (/home/ubuntu/puppeteer/dist/sites/connect.coyote.com.js:69:25)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Coyote.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Coyote.search (/home/ubuntu/puppeteer/dist/sites/connect.coyote.com.js:69:25)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Coyote.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}

http://54.219.50.46/screenshot/Coyote-search%20error.png 是登录页面。



DAT 搜索失败:
get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'DAT',
  user_id: '3',
  email: 'haulistix',
  password: 'Shostakovich5',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
DAT: searchPrepare



DAT: search page loaded
logout DAT: logout
screenshot: DAT-search error.png
DAT: search error SiteError { type: 'logout', msg: 'DAT: logout' }




get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
JB Hunt: searchPrepare
JB Hunt: search begin
JB Hunt: type origin
screenshot: JB Hunt-search error.png


JB Hunt 搜索失败:

get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
JB Hunt: searchPrepare
JB Hunt: search begin
JB Hunt: type origin
screenshot: JB Hunt-search error.png

JB Hunt: search error Error: Node is either not visible or not an HTMLElement
    at ElementHandle._clickablePoint (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/JSHandle.js:216:13)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async ElementHandle.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/JSHandle.js:282:20)
    at async DOMWorld.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:367:5)
    at async JBHunt.search (/home/ubuntu/puppeteer/dist/sites/www.jbhunt.com.js:29:9)
    at async JBHunt.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13)
  -- ASYNC --
    at ElementHandle.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at DOMWorld.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:367:18)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async JBHunt.search (/home/ubuntu/puppeteer/dist/sites/www.jbhunt.com.js:29:9)
    at async JBHunt.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1064:29)
    at JBHunt.search (/home/ubuntu/puppeteer/dist/sites/www.jbhunt.com.js:29:25)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async JBHunt.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13)








CH Robinson 搜索失败:

get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'CH Robinson',
  user_id: '3',
  email: 'brentprimelink',
  password: 'Annaleigh1',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
CH Robinson: searchPrepare
timeout CH Robinson: search page load timeout
CH Robinson: begin search

CH Robinson: wait for data-table
noData no data
screenshot: CH Robinson-search error.png
CH Robinson: search error SiteError { type: 'noData', msg: 'no data' }

http://54.219.50.46/screenshot/CH%20Robinson-search%20error.png 是个白屏。

timeout CH Robinson: search page load timeout 这个错误 是啥意思?














如果搜索没有结果, 按钮按钮会一直转圈,没法再次搜索。怎么解决呢?






daemon在爬取时, 登录失败时(如何判断登录失败,正常情况下,登录成功后能获取某个html element ,或者登录成功后url会变,否则 就是登录 失败。)
调用接口上报，接口会把 account status 改成 inactive，以后就不会使用这个网站搜索了。


网站登录成功后，在 redis 里记录一下，key 是 user_id:$user_id:site:$site:login ， 有个过期时间，超过过期时间，再重新登录，重新登录的话，看看登录页面是自动跳转到首页，
还是允许再次登录？




使用 jb hunt 搜索时,搜索结果显示如下
firstPickupLocation:{ "appointmentBegin": "2020-05-15 00:01:00", "appointmentEnd": "2020-05-15 14:03:00", "location": { "city": "LONG BEACH", "state": "CA", "__typename": "Location" }, "__typename": "Stop" }
有 __typename ,
有
stops:[object Object],[object Object]__typename:ElasticLoad
这些。