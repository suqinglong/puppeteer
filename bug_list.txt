修改个人资料,点击 update account settings 后, 保存成功,但是刷新页面,还是显示旧的资料。
ajax 提交时,about_me 是空字符串,没有取页面上输入的值。


右上角铃铛,点击没有弹出下拉列表。点击后,开发者控制台报js 错误。


mark all as read 待测试。



点击搜索按钮的一瞬间, 如果上一次 ajax 轮询获取上次搜索结果有返回了, 会直接显示在列表里面。



搜索条件是:
get task {
  task_id: 'fe1fedb255eb84a4538bfc80a1cf3e45',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'San Francisco, CA',
    origin_radius: '100',
    destination: 'San Francisco, CA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589542303
}

Uber Freight 报错:
Uber Freight: searchPrepare
Uber Freight: search page loaded
screenshot: Uber Freight-search error.png
Uber Freight: search error TimeoutError: waiting for selector "[data-baseweb=flex-grid] [data-baseweb="flex-grid-item"]" failed: timeout 10000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at UberFreight.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:34:25)
    at UberFreight.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at UberFreight.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:34:25)
    at UberFreight.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}


查看 http://54.219.50.46/screenshot/Uber%20Freight-search%20error.png ,显示的还在 sign in 的输入邮箱页面。






landstar 搜索时报错:
Landstar: searchPrepare
screenshot: Landstar-search error.png
Landstar: search error TimeoutError: waiting for selector "#OriginRadius" failed: timeout 30000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Landstar.search (/home/ubuntu/puppeteer/dist/sites/www.landstaronline.com.js:37:20)
    at Landstar.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Landstar.search (/home/ubuntu/puppeteer/dist/sites/www.landstaronline.com.js:37:20)
    at Landstar.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}

http://54.219.50.46/screenshot/Landstar-search%20error.png 是登录页面。




同时 enable landstar 和 werner 时, redis 里面应该有两个task, landstar 报错后, 另一个task 就没有了。不知道为什么。



sunteck 搜索时报错:
Sunteck: searchPrepare
logout Sunteck: logout in search page
screenshot: Sunteck-search error.png
Sunteck: search error SiteError { type: 'logout', msg: 'Sunteck: logout in search page' }

http://54.219.50.46/screenshot/Sunteck-search%20error.png 是登录页面




Echo search 搜索失败

Search doTask
Echo: searchPrepare
screenshot: Echo-search error.png
Echo: search error TimeoutError: waiting for selector ".search-btn" failed: timeout 5000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Echo.search (/home/ubuntu/puppeteer/dist/sites/echodrive.echo.com.js:32:25)
    at Echo.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Echo.search (/home/ubuntu/puppeteer/dist/sites/echodrive.echo.com.js:32:25)
    at Echo.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:24)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}

http://54.219.50.46/screenshot/Echo-search%20error.png  是登录页面。






coyote 搜索失败。

Coyote: searchPrepare
timeout Coyote: search page load timeout
Coyote: begin search
Coyote: search loaded
screenshot: Coyote-search error.png
Coyote: search error TimeoutError: waiting for selector "#export-to-excel:not(:disabled)" failed: timeout 10000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Coyote.search (/home/ubuntu/puppeteer/dist/sites/connect.coyote.com.js:69:25)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Coyote.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Coyote.search (/home/ubuntu/puppeteer/dist/sites/connect.coyote.com.js:69:25)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Coyote.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}

http://54.219.50.46/screenshot/Coyote-search%20error.png 是登录页面。



DAT 搜索失败:
get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'DAT',
  user_id: '3',
  email: 'haulistix',
  password: 'Shostakovich5',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
DAT: searchPrepare



DAT: search page loaded
logout DAT: logout
screenshot: DAT-search error.png
DAT: search error SiteError { type: 'logout', msg: 'DAT: logout' }




get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
JB Hunt: searchPrepare
JB Hunt: search begin
JB Hunt: type origin
screenshot: JB Hunt-search error.png


JB Hunt 搜索失败:

get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
JB Hunt: searchPrepare
JB Hunt: search begin
JB Hunt: type origin
screenshot: JB Hunt-search error.png

JB Hunt: search error Error: Node is either not visible or not an HTMLElement
    at ElementHandle._clickablePoint (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/JSHandle.js:216:13)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async ElementHandle.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/JSHandle.js:282:20)
    at async DOMWorld.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:367:5)
    at async JBHunt.search (/home/ubuntu/puppeteer/dist/sites/www.jbhunt.com.js:29:9)
    at async JBHunt.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13)
  -- ASYNC --
    at ElementHandle.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at DOMWorld.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:367:18)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async JBHunt.search (/home/ubuntu/puppeteer/dist/sites/www.jbhunt.com.js:29:9)
    at async JBHunt.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.click (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1064:29)
    at JBHunt.search (/home/ubuntu/puppeteer/dist/sites/www.jbhunt.com.js:29:25)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async JBHunt.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:32:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:41:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13)








CH Robinson 搜索失败:

get task {
  task_id: '4f75b36498593245142cba2c0b3fae7c',
  site: 'CH Robinson',
  user_id: '3',
  email: 'brentprimelink',
  password: 'Annaleigh1',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-15',
    equipment: 'Van'
  },
  time: 1589544632
}
Search doTask
CH Robinson: searchPrepare
timeout CH Robinson: search page load timeout
CH Robinson: begin search

CH Robinson: wait for data-table
noData no data
screenshot: CH Robinson-search error.png
CH Robinson: search error SiteError { type: 'noData', msg: 'no data' }

http://54.219.50.46/screenshot/CH%20Robinson-search%20error.png 是个白屏。

timeout CH Robinson: search page load timeout 这个错误 是啥意思?














如果搜索没有结果, 按钮按钮会一直转圈,没法再次搜索。怎么解决呢?






daemon在爬取时, 登录失败时(如何判断登录失败,正常情况下,登录成功后能获取某个html element ,或者登录成功后url会变,否则 就是登录 失败。)
调用接口上报，接口会把 account status 改成 inactive，以后就不会使用这个网站搜索了。


网站登录成功后，在 redis 里记录一下，key 是 user_id:$user_id:site:$site:login ， 有个过期时间，超过过期时间，再重新登录，重新登录的话，看看登录页面是自动跳转到首页，
还是允许再次登录？




使用 jb hunt 搜索时,搜索结果显示如下
firstPickupLocation:{ "appointmentBegin": "2020-05-15 00:01:00", "appointmentEnd": "2020-05-15 14:03:00", "location": { "city": "LONG BEACH", "state": "CA", "__typename": "Location" }, "__typename": "Stop" }
有 __typename ,
有
stops:[object Object],[object Object]__typename:ElasticLoad
这些。





2020-05-19
==============

get task {
  task_id: '18ea408b59d6eede24c8b3f054bf92d5',
  site: 'Landstar',
  user_id: '3',
  email: 'ajgtranspo',
  password: 'Loaded2020',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-19',
    equipment: 'Van'
  },
  time: 1589896618
}
create browserWSEndpoint
Search doTask
Landstar: search begin
Landstar: need login
Landstar: login begin
Landstar: login success
screenshot: Landstar-search error.png
Landstar: search error TypeError: Invalid date
    at Object.default (/home/ubuntu/puppeteer/node_modules/dateformat/lib/dateformat.js:39:17)
    at formateDate (/home/ubuntu/puppeteer/dist/tools/index.js:101:32)
    at /home/ubuntu/puppeteer/dist/tools/index.js:44:19
    at Array.map (<anonymous>)
    at Object.ModifyPostData (/home/ubuntu/puppeteer/dist/tools/index.js:35:28)
    at Landstar.search (/home/ubuntu/puppeteer/dist/sites/www.landstaronline.com.js:110:44)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Landstar.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:24:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:39:9)



landstar 搜索报错。 看截图,搜索是成功了的,数据已经出来了。




Uber Freight: { success: true, data: null }
SiteStack await callback end 4
(node:15090) UnhandledPromiseRejectionWarning: TypeError: Invalid date
    at Object.default (/home/ubuntu/puppeteer/node_modules/dateformat/lib/dateformat.js:39:17)
    at UberDetailPage.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:195:46)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async UberDetailPage.doSearch (/home/ubuntu/puppeteer/dist/tools/siteStack.js:66:24)
(node:15090) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 1)
(node:15090) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.
(node:15090) UnhandledPromiseRejectionWarning: TypeError: Invalid date
    at Object.default (/home/ubuntu/puppeteer/node_modules/dateformat/lib/dateformat.js:39:17)
    at UberDetailPage.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:195:46)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async UberDetailPage.doSearch (/home/ubuntu/puppeteer/dist/tools/siteStack.js:66:24)
(node:15090) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 2)
(node:15090) UnhandledPromiseRejectionWarning: TypeError: Invalid date
    at Object.default (/home/ubuntu/puppeteer/node_modules/dateformat/lib/dateformat.js:39:17)
    at UberDetailPage.search (/home/ubuntu/puppeteer/dist/sites/uber.freight.js:195:46)
    at runMicrotasks (<anonymous>)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async UberDetailPage.doSearch (/home/ubuntu/puppeteer/dist/tools/siteStack.js:66:24)
(node:15090) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 3)
Uber Freight: { success: true, data: null }
SiteStack await callback end 3


Uber 也是这个错误,应该都是日期格式化的问题。






当报了上面两个错误后,再次搜索,daemon不 work 了,在 daemon.log 里面也看不到日志了。 得想办法做到一个网站搜索出错, daemon 也能处理别的task





get task {
  task_id: '6fe54e3a095d0e59cee89bf3063cf778',
  site: 'Coyote',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'KeepLoaded20!',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-19',
    equipment: 'Van'
  },
  time: 1589897200
}
Search doTask
Coyote: search begin
searchTimeout Coyote: search page load timeout
screenshot: Coyote-search error.png
Coyote: search error SiteError {
  type: 'searchTimeout',
  msg: 'Coyote: search page load timeout'
}



查看了一个截图,是白屏, 而且这个日志是很快打出来的,不像是加载半天,加载超时导致的。

# todo
Coyote 多进程下载目录会不会冲突



get task {
  task_id: '6fe54e3a095d0e59cee89bf3063cf778',
  site: 'Sunteck',
  user_id: '3',
  email: 'ajgtransportation@gmail.com',
  password: 'KeepLoaded19',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-19',
    equipment: 'Van'
  },
  time: 1589897200
}
Search doTask
Sunteck: search begin
Sunteck: need login
Sunteck: login begin
screenshot: Sunteck-login error.png
Sunteck: login error TimeoutError: waiting for selector "#load_search_form" failed: timeout 10000ms exceeded
    at new WaitTask (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:549:28)
    at DOMWorld._waitForSelectorOrXPath (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:478:22)
    at DOMWorld.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/DOMWorld.js:432:17)
    at Frame.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/FrameManager.js:627:47)
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:112:23)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Sunteck.login (/home/ubuntu/puppeteer/dist/sites/carriers.suntecktts.com.js:25:25)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Sunteck.doLogin (/home/ubuntu/puppeteer/dist/sites/searchSite.js:68:13)
    at async Sunteck.beforeSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:44:13)
  -- ASYNC --
    at Frame.<anonymous> (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/helper.js:111:15)
    at Page.waitForSelector (/home/ubuntu/puppeteer/node_modules/puppeteer/lib/Page.js:1122:29)
    at Sunteck.login (/home/ubuntu/puppeteer/dist/sites/carriers.suntecktts.com.js:25:25)
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async Sunteck.doLogin (/home/ubuntu/puppeteer/dist/sites/searchSite.js:68:13)
    at async Sunteck.beforeSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:44:13)
    at async Sunteck.doSearch (/home/ubuntu/puppeteer/dist/sites/searchSite.js:23:13)
    at async Search.doTask (/home/ubuntu/puppeteer/dist/search.js:39:9)
    at async Tasks.getTask (/home/ubuntu/puppeteer/dist/tasks.js:42:13) {
  name: 'TimeoutError'
}
unableToLogin Sunteck: login faild
screenshot: Sunteck-search error.png
Sunteck: search error SiteError { type: 'unableToLogin', msg: 'Sunteck: login faild' }


查看了 Sunteck-login error.png 和  Sunteck-search error.png ,两个网页都是登录成功后的搜索页面,可能是对方网站改变前端了? 没有我们要找的
html element ?






get task {
  task_id: '4000689264e0ff5ad60ef90ab78b9178',
  site: 'JB Hunt',
  user_id: '3',
  email: 'dispatch@ajgtransport.com',
  password: 'Alwaysloaded400',
  criteria: {
    origin: 'Atwater, CA',
    origin_radius: '100',
    destination: 'Sumner, WA',
    destination_radius: '100',
    pick_up_date: '2020-05-19',
    equipment: 'Van'
  },
  time: 1589897806
}
Search doTask
JB Hunt: search begin
JB Hunt: need not login
JB Hunt: type origin
JB Hunt: type destination
JB Hunt: type equipment
JB Hunt: click search btn
JB Hunt: has result
noData JB Hunt: no data
screenshot: JB Hunt-search error.png
JB Hunt: search error SiteError { type: 'noData', msg: 'JB Hunt: no data' }


JB Hunt 第一次搜索时,有结果,是正确 的。第二次相同 的条件 再次搜索时,报以上错误。截图是搜索页面刚打开的样子,搜索条件还没有填充。


